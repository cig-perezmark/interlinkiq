{"version":3,"sources":["audit_review_script.js"],"names":["fetchData","response","data","parseDate","cleanedData","regeneratorRuntime","async","_context","prev","next","awrap","fetch","sent","json","console","log","dateString","_dateString$split$map2","_slicedToArray","split","map","Number","month","day","year","Date","item","parseDuration","start","end","reviewed_by","trim","annual_review_count","parseInt","total_audits","audit_report_start","audit_report_duration","audit_certificate_duration","audit_corrective_action_start","audit_corrective_action_duration","reviewed_start","reviewed_duration","root","am5","Root","am5themes_Animated","chart","children","push","am5xy","XYChart","panX","panY","wheelX","verticalLayout","legend","p50","AxisRendererX","cellStartLocation","cellEndLocation","minGridDistance","tooltip","Tooltip","xAxis","container","grid","template","set","setAll","yAxis","yAxes","ValueAxis","layout","Legend","centerX","AxisRendererY","opposite","syncWithAxis","makeSeries","name","fieldName","color","stacked","baseFieldName","isDuration","addToLegend","series","xAxes","CategoryAxis","categoryField","renderer","openValueYField","stroke","get","columns","strokeWidth","duration","target","dataItem","ColumnSeries","valueYField","categoryXField","tooltipText","tooltipY","adapters","yAxis2","appear","Label","text","x","marginTop","dy","t0","stop"],"mappings":"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","file":"audit_review_script.min.js","sourcesContent":["async function fetchData() {\r\n    try {\r\n        const response = await fetch('AnalyticsIQ/audit_annual_data.php');\r\n        const data = await response.json();\r\n        console.log(data); // Log the fetched data\r\n\r\n        // Helper function to parse date strings\r\n        const parseDate = (dateString) => {\r\n            const [month, day, year] = dateString.split('/').map(Number);\r\n            return new Date(year, month - 1, day);\r\n        };\r\n\r\n        // Clean data to remove extra spaces and format correctly\r\n        const cleanedData = data.map(item => {\r\n            const parseDuration = (start, end) => (parseDate(end) - new Date(start)) / (1000 * 60 * 60 * 24);\r\n            return {\r\n                reviewed_by: item.reviewed_by.trim(),\r\n                annual_review_count: parseInt(item.annual_review_count, 10),\r\n                total_audits: parseInt(item.total_audits, 10),\r\n                audit_report_start: new Date(item['Audit Report Date']),\r\n                audit_report_duration: parseDuration(item['Audit Report Date'], item['Audit Report End Date']),\r\n                audit_certificate_start: new Date(item['Audit Certificate Date']),\r\n                audit_certificate_duration: parseDuration(item['Audit Certificate Date'], item['Audit Certificate End Date']),\r\n                audit_corrective_action_start: new Date(item['Audit Corrective Action Date']),\r\n                audit_corrective_action_duration: parseDuration(item['Audit Corrective Action Date'], item['Audit Corrective Action End Date']),\r\n                reviewed_start: new Date(item['Reviewed Date']),\r\n                reviewed_duration: parseDuration(item['Reviewed Date'], item['Reviewed Due'])\r\n            };\r\n        });\r\n\r\n        am5.ready(function() {\r\n            const root = am5.Root.new(\"auditChartdiv123\");\r\n\r\n            // Set themes\r\n            root.setThemes([am5themes_Animated.new(root)]);\r\n\r\n            // Create chart\r\n            const chart = root.container.children.push(am5xy.XYChart.new(root, {\r\n                panX: false,\r\n                panY: false,\r\n                wheelX: \"none\", // Disable zooming\r\n                wheelY: \"none\", // Disable zooming\r\n                layout: root.verticalLayout\r\n            }));\r\n\r\n            // Add legend\r\n            const legend = chart.children.push(\r\n                am5.Legend.new(root, {\r\n                    centerX: am5.p50,\r\n                    x: am5.p50,\r\n                    marginTop: 20 // Add margin top to create space\r\n                })\r\n            );\r\n\r\n            // Create axes\r\n            const xAxis = chart.xAxes.push(am5xy.CategoryAxis.new(root, {\r\n                categoryField: \"reviewed_by\",\r\n                renderer: am5xy.AxisRendererX.new(root, {\r\n                    cellStartLocation: 0.1,\r\n                    cellEndLocation: 0.9,\r\n                    minGridDistance: 10\r\n                }),\r\n                tooltip: am5.Tooltip.new(root, {})\r\n            }));\r\n\r\n            xAxis.get(\"renderer\").labels.template.setAll({\r\n                forceHidden: true\r\n            });\r\n            xAxis.get(\"renderer\").grid.template.set(\"forceHidden\", true);\r\n            xAxis.data.setAll(cleanedData);\r\n\r\n            const yAxis = chart.yAxes.push(am5xy.ValueAxis.new(root, {\r\n                renderer: am5xy.AxisRendererY.new(root, {})\r\n            }));\r\n\r\n            const yAxis2 = chart.yAxes.push(am5xy.ValueAxis.new(root, {\r\n                renderer: am5xy.AxisRendererY.new(root, { opposite: true }),\r\n                syncWithAxis: yAxis\r\n            }));\r\n\r\n            // Add series\r\n            function makeSeries(name, fieldName, color, stacked, baseFieldName, isDuration, addToLegend, yAxis) {\r\n                const series = chart.series.push(am5xy.ColumnSeries.new(root, {\r\n                    name: name,\r\n                    xAxis: xAxis,\r\n                    yAxis: yAxis,\r\n                    stacked: stacked,\r\n                    valueYField: fieldName,\r\n                    openValueYField: baseFieldName,\r\n                    categoryXField: \"reviewed_by\",\r\n                    stroke: color,\r\n                    fill: color\r\n                }));\r\n\r\n                series.columns.template.setAll({\r\n                    tooltipText: \"{name}: {valueY}\",\r\n                    width: am5.percent(50), // Adjusted width of bars\r\n                    tooltipY: 0,\r\n                    strokeWidth: 0 // Remove border\r\n                });\r\n\r\n                // Change color based on duration\r\n                if (isDuration) {\r\n                    series.columns.template.adapters.add(\"fill\", (fill, target) => {\r\n                        const duration = target.dataItem.get(\"valueY\");\r\n                        if (duration <= 30) return am5.color(0xFF0000); // Red for 30 days or less\r\n                        if (duration <= 60) return am5.color(0xFFA500); // Orange for 60 days or less\r\n                        if (duration <= 90) return am5.color(0xFFD700); // Yellow for 90 days or less\r\n                        return am5.color(0x5bd75b); // Green for more than 90 days\r\n                    });\r\n                }\r\n\r\n                series.data.setAll(cleanedData);\r\n                series.appear();\r\n                if (addToLegend) legend.data.push(series);\r\n            }\r\n\r\n            // Create stacked series for each date pair\r\n            makeSeries(\"Audit Report\", \"audit_report_start\", am5.color(0x2c4e31), false, null, false, true, yAxis);\r\n            makeSeries(\"Audit Report Duration\", \"audit_report_duration\", am5.color(0xFFD700), true, \"audit_report_start\", true, false, yAxis);\r\n\r\n            makeSeries(\"Audit Certificate\", \"audit_certificate_start\", am5.color(0x3e6e45), false, null, false, true, yAxis);\r\n            makeSeries(\"Audit Certificate Duration\", \"audit_certificate_duration\", am5.color(0x4A731C), true, \"audit_certificate_start\", true, false, yAxis);\r\n\r\n            makeSeries(\"Audit Corrective Action\", \"audit_corrective_action_start\", am5.color(0x518f5a), false, null, false, true, yAxis);\r\n            makeSeries(\"Audit Corrective Action Duration\", \"audit_corrective_action_duration\", am5.color(0x883407), true, \"audit_corrective_action_start\", true, false, yAxis);\r\n\r\n            makeSeries(\"Reviewed\", \"reviewed_start\", am5.color(0x097969), false, null, false, true, yAxis);\r\n            makeSeries(\"Reviewed Duration\", \"reviewed_duration\", am5.color(0x32CD32), true, \"reviewed_start\", true, false, yAxis);\r\n\r\n            // Individual series\r\n            makeSeries(\"Annual Review\", \"annual_review_count\", am5.color(0x0096FF), false, null, false, true, yAxis2);\r\n            makeSeries(\"Audit\", \"total_audits\", am5.color(0x87CEEB), false, null, false, true, yAxis2);\r\n\r\n            // Make stuff animate on load\r\n            chart.appear(1000, 100);\r\n\r\n            // Add \"Reviewed by:\" label within the chart\r\n            chart.children.push(am5.Label.new(root, {\r\n                text: \"Reviewed by: \" + cleanedData[0].reviewed_by,\r\n                fontSize: 20,\r\n                centerX: am5.p50,\r\n                x: am5.p50,\r\n                marginTop: 20,\r\n                dy: 10\r\n            }));\r\n        });\r\n    } catch (error) {\r\n        console.error('Error fetching data:', error);\r\n    }\r\n}\r\n\r\nfetchData();\r\n"]}