"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],r=!0,o=!1,n=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){o=!0,n=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw n}}return a}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var currentRoot=null,complianceRoot=null,auditRoot=null;function displayChart(e){[currentRoot,complianceRoot,auditRoot].forEach(function(e){e&&e.dispose()}),document.querySelector("#modalChart .modal-title").innerText="Customer Name: "+e.vendor_name,(currentRoot=am5.Root.new("requirementChartDiv")).setThemes([am5themes_Animated.new(currentRoot)]);var t=currentRoot.container.children.push(am5xy.XYChart.new(currentRoot,{panX:!1,panY:!1,wheelX:"none",wheelY:"none",pinchZoomX:!1}));t.set("cursor",am5xy.XYCursor.new(currentRoot,{behavior:"none"})).lineY.set("visible",!1);var a=t.xAxes.push(am5xy.CategoryAxis.new(currentRoot,{categoryField:"category",renderer:am5xy.AxisRendererX.new(currentRoot,{minGridDistance:30})})),r=t.yAxes.push(am5xy.ValueAxis.new(currentRoot,{renderer:am5xy.AxisRendererY.new(currentRoot,{})}));a.get("renderer").labels.template.setAll({rotation:-30,centerY:am5.p50,centerX:am5.p100});var o=t.series.push(am5xy.ColumnSeries.new(currentRoot,{name:"Requirements",xAxis:a,yAxis:r,valueYField:"value",categoryXField:"category"})),n=[{category:"Requirements",value:e.document_count+e.document_other_count,color:am5.color(5089023)},{category:"Non Expired",value:e.non_expired,color:am5.color(3329330)},{category:"Expired",value:e.expired,color:am5.color(16711680)},{category:"Nearly Expired 30 days",value:e.nearly_expired_30,color:am5.color(16725044)},{category:"Nearly Expired 60 days",value:e.nearly_expired_60,color:am5.color(16758579)},{category:"Nearly Expired 90 days",value:e.nearly_expired_90,color:am5.color(16766720)}];o.data.setAll(n),a.data.setAll(n),o.columns.template.setAll({tooltipText:"{category}: {valueY}",fill:function(e){return e.dataItem.dataContext.color},stroke:function(e){return e.dataItem.dataContext.color},width:am5.percent(120),fillOpacity:.8,strokeOpacity:.8}),o.columns.template.adapters.add("fill",function(e,t){return t.dataItem.dataContext.color}),o.columns.template.adapters.add("stroke",function(e,t){return t.dataItem.dataContext.color}),o.columns.template.set("draw",function(e,t){var a=t.getPrivate("width",0),r=t.getPrivate("height",0);e.moveTo(0,r),e.bezierCurveTo(a/4,r,a/4,0,a/2,0),e.bezierCurveTo(a-a/4,0,a-a/4,r,a,r)}),o.appear(1e3),t.appear(1e3,100),(complianceRoot=am5.Root.new("complianceChartDiv")).setThemes([am5themes_Animated.new(complianceRoot)]);var i=complianceRoot.container.children.push(am5percent.PieChart.new(complianceRoot,{radius:am5.percent(65)})).series.push(am5percent.PieSeries.new(complianceRoot,{valueField:"value",categoryField:"category",colors:am5.ColorSet.new(complianceRoot,{colors:[am5.color(3329330),am5.color(16711680)]})}));i.data.setAll([{category:"Compliance",value:e.compliant_count},{category:"Non-Compliance",value:e.non_compliant_count}]),i.slices.template.setAll({tooltipText:"{category}: {value}"});var c=[{reviewed_by:e.reviewed_by,annual_review_count:e.annual_review_count,total_audits:e.total_audits,audit_report_start:parseDate(e.audit_report_date.trim()),audit_report_duration:calculateDuration(e.audit_report_date,e.audit_report_end_date),audit_certificate_start:parseDate(e.audit_certificate_date.trim()),audit_certificate_duration:calculateDuration(e.audit_certificate_date,e.audit_certificate_end_date),audit_corrective_action_start:parseDate(e.audit_action_date.trim()),audit_corrective_action_duration:calculateDuration(e.audit_action_date,e.audit_action_end_date),reviewed_start:parseDate(e.reviewed_date.trim()),reviewed_duration:calculateDuration(e.reviewed_date,e.reviewed_due)}];0<c.length&&am5.ready(function(){try{var e=function(e,t,a,r,o,n){var i=l.series.push(am5xy.ColumnSeries.new(auditRoot,{name:e,xAxis:d,yAxis:n,valueYField:t,categoryXField:"reviewed_by",stacked:o,fill:a}));return i.columns.template.setAll({tooltipText:r?"{name}: {valueY} days":"{name}: {valueY}",width:am5.percent(90),strokeOpacity:0,fillOpacity:10}),r&&i.columns.template.adapters.add("fill",function(e,t){var a=t.dataItem.get("valueY");return a<=30?am5.color(16711680):a<=60?am5.color(16753920):a<=90?am5.color(16766720):am5.color(3329330)}),i.data.setAll(c),i.appear(),"Audit Report Duration"!==e&&"Audit Certificate Duration"!==e&&"Audit Corrective Action Duration"!==e&&"Reviewed Duration"!==e&&u.data.push(i),i.bullets.push(function(){return am5.Bullet.new(auditRoot,{locationY:.5,sprite:am5.Label.new(auditRoot,{text:r?"Duration: {valueY} days \n":"Start: {valueY} \n",fill:auditRoot.interfaceColors.get("alternativeText"),centerY:am5.p50,centerX:am5.p50,populateText:!0,adapters:{text:function(e,t){return null!=t.dataItem.get("valueY")?e:""}}})})}),i};(auditRoot=am5.Root.new("auditChartdiv")).setThemes([am5themes_Animated.new(auditRoot)]);var l=auditRoot.container.children.push(am5xy.XYChart.new(auditRoot,{panX:!1,panY:!1,wheelX:"none",wheelY:"none",layout:auditRoot.verticalLayout,marginTop:20})),u=l.children.push(am5.Legend.new(auditRoot,{centerX:am5.p50,x:am5.p50,marginTop:20})),d=l.xAxes.push(am5xy.CategoryAxis.new(auditRoot,{categoryField:"reviewed_by",renderer:am5xy.AxisRendererX.new(auditRoot,{cellStartLocation:.1,cellEndLocation:.9})}));d.data.setAll(c),d.get("renderer").labels.template.adapters.add("text",function(e,t){return"Reviewed by: "+e}),d.get("renderer").labels.template.setAll({fontSize:16});var t=l.yAxes.push(am5xy.ValueAxis.new(auditRoot,{renderer:am5xy.AxisRendererY.new(auditRoot,{})}));l.yAxes.push(am5xy.ValueAxis.new(auditRoot,{renderer:am5xy.AxisRendererY.new(auditRoot,{opposite:!0})}));e("Audit Report Start","audit_report_start",am5.color(8154835),!1,!1,t),e("Audit Report Duration","audit_report_duration",am5.color(16766720),!0,!0,t),e("Audit Certificate Start","audit_certificate_start",am5.color(38655),!1,!1,t),e("Audit Certificate Duration","audit_certificate_duration",am5.color(4879132),!0,!0,t),e("Audit Corrective Action Start","audit_corrective_action_start",am5.color(14254541),!1,!1,t),e("Audit Corrective Action Duration","audit_corrective_action_duration",am5.color(8926215),!0,!0,t),e("Reviewed Start","reviewed_start",am5.color(16416882),!1,!1,t),e("Reviewed Duration","reviewed_duration",am5.color(3329330),!0,!0,t),l.appear(1e3,100)}catch(e){console.log(e)}}),$("#modalChart").modal("show")}function parseDate(e){var t=_slicedToArray(e.split("/").map(Number),3),a=t[0],r=t[1],o=t[2];return new Date(o,a-1,r)}function calculateDuration(e,t){var a=parseDate(e.trim());return(parseDate(t.trim())-a)/864e5}$("#modalChart").on("shown.bs.modal",function(e){var t=$(e.relatedTarget).data("id");fetch("AnalyticsIQ/fetch_customer_data.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"id="+t}).then(function(e){if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.json()}).then(function(e){console.log(e),displayChart(e)}).catch(function(e){console.error("Error fetching or processing data:",e),alert("An error occurred while fetching the data. Please try again later.")})}),am5.ready(function(){var e=am5.Root.new("waterfallChart1");e.setThemes([am5themes_Animated.new(e)]);var t=e.container.children.push(am5xy.XYChart.new(e,{panX:!1,panY:!1,paddingLeft:0})),a=am5xy.AxisRendererX.new(e,{minGridDistance:30,minorGridEnabled:!0}),r=t.xAxes.push(am5xy.CategoryAxis.new(e,{maxDeviation:0,categoryField:"category",renderer:a,tooltip:am5.Tooltip.new(e,{})}));a.grid.template.setAll({location:1});var o=t.yAxes.push(am5xy.ValueAxis.new(e,{maxDeviation:0,min:0,renderer:am5xy.AxisRendererY.new(e,{strokeOpacity:.1}),tooltip:am5.Tooltip.new(e,{})})),n=(t.set("cursor",am5xy.XYCursor.new(e,{xAxis:r,yAxis:o})),t.series.push(am5xy.ColumnSeries.new(e,{xAxis:r,yAxis:o,valueYField:"value",openValueYField:"open",categoryXField:"category"})));n.columns.template.setAll({templateField:"columnConfig",strokeOpacity:0}),n.bullets.push(function(){return am5.Bullet.new(e,{sprite:am5.Label.new(e,{text:"{displayValue}",centerY:am5.p50,centerX:am5.p50,populateText:!0})})});var i=t.series.push(am5xy.StepLineSeries.new(e,{xAxis:r,yAxis:o,valueYField:"stepValue",categoryXField:"category",noRisers:!0,locationX:.65,stroke:e.interfaceColors.get("alternativeBackground")}));i.strokes.template.setAll({strokeDasharray:[3,3]});am5.ColorSet.new(e,{});fetch("AnalyticsIQ/customer_send_data.php").then(function(e){return e.json()}).then(function(e){var t=[{category:"Total Send",value:parseInt(e.donutData.total_send),open:0,stepValue:parseInt(e.donutData.total_send),columnConfig:{fill:am5.color(5089023)},displayValue:parseInt(e.donutData.total_send)},{category:"Pending",value:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending),open:parseInt(e.donutData.total_send),stepValue:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending),columnConfig:{fill:am5.color(16038211)},displayValue:parseInt(e.donutData.pending)},{category:"Approved",value:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved),open:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending),stepValue:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved),columnConfig:{fill:am5.color(3329330)},displayValue:parseInt(e.donutData.approved)},{category:"Non Approved",value:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved)-parseInt(e.donutData.non_approved),open:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved),stepValue:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved)-parseInt(e.donutData.non_approved),columnConfig:{fill:am5.color(16711680)},displayValue:parseInt(e.donutData.non_approved)},{category:"Emergency Use Only",value:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved)-parseInt(e.donutData.non_approved)+parseInt(e.donutData.emergency_use_only),open:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved)-parseInt(e.donutData.non_approved),stepValue:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved)-parseInt(e.donutData.non_approved)+parseInt(e.donutData.emergency_use_only),columnConfig:{fill:am5.color(16744576)},displayValue:parseInt(e.donutData.emergency_use_only)},{category:"Do Not Use",value:parseInt(e.donutData.total_send)-parseInt(e.donutData.pending)-parseInt(e.donutData.approved)-parseInt(e.donutData.non_approved)+parseInt(e.donutData.emergency_use_only),open:0,columnConfig:{fill:am5.color(16776960)},displayValue:parseInt(e.donutData.do_not_use)}];r.data.setAll(t),n.data.setAll(t),i.data.setAll(t)}).catch(function(e){return console.error("Error fetching data:",e)})}),am5.ready(function(){var r=am5.Root.new("receivedchartdiv");r.setThemes([am5themes_Animated.new(r)]);var o=r.container.children.push(am5xy.XYChart.new(r,{panX:!1,panY:!1,wheelX:"none",wheelY:"none",pinchZoomY:!1}));o.set("cursor",am5xy.XYCursor.new(r,{})).lineX.set("visible",!1);var e=am5xy.AxisRendererY.new(r,{minGridDistance:30}),n=o.yAxes.push(am5xy.CategoryAxis.new(r,{maxDeviation:.3,categoryField:"name",renderer:e})),i=o.xAxes.push(am5xy.ValueAxis.new(r,{renderer:am5xy.AxisRendererX.new(r,{})}));fetch("AnalyticsIQ/customer_received_data.php").then(function(e){return e.json()}).then(function(e){if(0!==e.length){var t=[{name:"Compliance",value:e.reduce(function(e,t){return e+parseFloat(t.compliance_percentage)},0),color:am5.color(65280)},{name:"Non Compliance",value:e.reduce(function(e,t){return e+parseInt(t.d_non_compliance)},0),color:am5.color(16711680)},{name:"Pending",value:e.reduce(function(e,t){return e+parseInt(t.pending_count)},0),color:am5.color(16753920)},{name:"Approved",value:e.reduce(function(e,t){return e+parseInt(t.approved_count)},0),color:am5.color(3329330)},{name:"Non Approved",value:e.reduce(function(e,t){return e+parseInt(t.non_approved_count)},0),color:am5.color(16737095)},{name:"Emergency Use Only",value:e.reduce(function(e,t){return e+parseInt(t.emergency_use_only_count)},0),color:am5.color(16761035)},{name:"Do Not Use",value:e.reduce(function(e,t){return e+parseInt(t.do_not_use_count)},0),color:am5.color(16776960)},{name:"Total Received",value:e.reduce(function(e,t){return e+parseInt(t.received_count)},0),color:am5.color(5089023)}],a=o.series.push(am5xy.ColumnSeries.new(r,{xAxis:i,yAxis:n,valueXField:"value",categoryYField:"name",tooltip:am5.Tooltip.new(r,{labelText:"{name}: {valueX}"})}));a.columns.template.setAll({cornerRadiusTL:5,cornerRadiusBL:5}),a.columns.template.adapters.add("fill",function(e,t){return t.dataItem.dataContext.color}),a.columns.template.adapters.add("stroke",function(e,t){return t.dataItem.dataContext.color}),a.data.setAll(t),n.data.setAll(t)}else console.error("No data received")}).catch(function(e){console.error("Error fetching data:",e)})});
//# sourceMappingURL=customer_chart.min.js.map
